1. **Hello World Scheduler**

   This is the starting point of using PowerShell scripts for scheduling tasks.

   We try to write a PowerShell script that will add a custom executable (hello_world_scheduler.exe) as a "scheduled" task. 
   This executable writes "Hello world" 10 times with an additional variable to distinguish each write every 1 minute into a file called output.txt.

   Code: hello_world_scheduler.exe

2. **Startup Addition**

   We try to write a PowerShell script to add any executable to the startup folder so that it gets executed on every boot.
   As an attacker, one can add their malware or part of their malware to the startup folder to make it more persistent and dangerous.

   In our scenario, to understand the working, we have attempted to add Command Prompt to the startup folder.
   We can observe the .lnk file being added, basically a link file to the application.

   Code: startup.ps1

3. **Hello World Startup Mashup**

   We try to combine 1 and 2.
   We write a PowerShell script that adds Command Prompt to the startup, which executes a code similar to the Hello World Scheduler to write "Hello world" into a file.

   Code: hello-world_startup.ps1

4. **Custom Startup Mashup**

   Instead of using a normal application/executable like Command Prompt, we do the same as in 3 but add a custom executable (myC.exe) to the startup folder.

   Code: myC-startup.ps1

5. **Additional - Port Scheduler (NOTE - ADDITIONAL WORK!!!)**

   Here we try to write a PowerShell script that opens a connection on a port and then closes it.
   We attempt to simulate the way attackers might try to keep in touch with the target host periodically.
   We run the PowerShell script that runs the executable which handles the connection opening and closing.

   Code: port_scheduler.ps1

6. **PowerShell Execution Policy**

   Rather than using a PowerShell script to run commands present in an executable, we try to run a command directly using PowerShell commands itself.
   Sometimes, this requires changing the Execution Policy in our PowerShell, which is "Restricted" by default.
   We can try the "Bypass" or the "Unrestricted" option.

   Code: power.exe

7. **Advanced C2**

   The server (attacker) connects with the victim client. Due to a scheduler injected into the victim, the victim keeps executing the command sent by the attacker.
   In our scenario, the attacker commands the victim to send the contents of a file to the attacker server. Any changes are also reflected because of the scheduler that keeps periodically sending the file's contents to the attackers. This can be useful for exfiltrating the contents of a password file. In our case, the file data being exfiltrated is example.txt.

   Code: server.exe on the attacker host and client_scheduler.ps1 on the victim host (Make sure to update the IP addresses in the client code to the attacker's IP, and ideally, for our code snippet, both the client and server should be on the same network to make it easier).
