#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main()
{
    // Set the PowerShell execution policy to "Unrestricted"
    const char* setExecutionPolicyCmd = "powershell.exe -Command \"Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy Unrestricted -Force\"";

    // Open PowerShell and set the execution policy
    system(setExecutionPolicyCmd);

    // Define the Hello World script
    const char* script = "$message = 'Hello, World!'; Write-Output $message; Read-Host";

    // Build the PowerShell command
    const char* powershellCmd = "powershell.exe -NoExit -Command \"& { ";
    char* fullCmd = malloc(strlen(powershellCmd) + strlen(script) + 4);  // Allocate memory for the full command
    sprintf(fullCmd, "%s %s }\"", powershellCmd, script);

    // Open PowerShell and execute the Hello World script
    system(fullCmd);

    // Clean up
    free(fullCmd);

    return 0;
}