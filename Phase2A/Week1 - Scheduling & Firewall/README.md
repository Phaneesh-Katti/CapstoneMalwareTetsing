Week 1 → Advanced Command and Control (C2)
│
├── 1. Understand the working of a scheduler to ensure that persistence of the C2 malware sample is assured.
│
├── 2. Use different DLL hijacking techniques to load and persist malicious DLLs.
│
├── 3. Use images from the Internet to generate and propagate C2 commands as steg-images.
│
├── 4. Employ the concept of whitelisting and blacklisting IP addresses by hosting multiple instances of an Apache Server using Virtual Hosting.
│
├── 5. Understand the basics of Powershell scripting and how Powershell can be used to turn the Windows Defender and Firewall off.
│
├── NOTE: Please execute the file name mentioned under the "code" heading under each serial number.
│     ├── It may be necessary to change the Execution Policy of our Powershell to perform certain tasks.
│     │     Open Powershell as an “Administrator” and run the following command:
│     │     ```
│     │     Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy Unrestricted -Force
│     │     ```
│     │     It is advised to set the execution policy back to restricted (which is the default setting) after analyzing the malware behaviors:
│     │     ```
│     │     Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy Restricted -Force
│     │     ```
│     │     You can verify the execution policy by using:
│     │     ```
│     │     Get-ExecutionPolicy
│     │     ```
│     └── Code: [Filename]
│
└── Routing through the Week 1 Maze
      │
      ├── 1. Hello World Scheduler
      │     ├── This is the starting point of using PowerShell scripts for scheduling tasks.
      │     ├── We try to write a PowerShell script that will add a custom executable (hello_world_scheduler.exe) as a "scheduled" task.
      │     └── Code: hello_world_scheduler.exe
      │
      ├── 2. Startup Addition
      │     ├── We try to write a PowerShell script to add any executable to the startup folder, so that it gets executed on every boot.
      │     ├── As an attacker, one can add their malware or part of their malware to the startup folder to make it more persistent and dangerous.
      │     ├── In our scenario, we have attempted to add Command Prompt to the startup folder.
      │     └── Code: startup.ps1
      │
      ├── 3. Hello World Startup Mashup
      │     ├── We try to combine 1. and 2.
      │     ├── We write a PowerShell script that adds CMD to startup, which executes a code similar to the Hello World Scheduler to write "Hello, World!" into a file.
      │     └── Code: hello-world_startup.ps1
      │
      ├── 4. Custom Startup Mashup
      │     ├── Instead of using a normal application/executable like CMD, we do the same as 3. but add a custom executable (myC.exe) to the startup folder.
      │     └── Code: myC-startup.ps1
      │
      ├── 5. Additional - Port Scheduler (NOTE - ADDITIONAL WORK!!!)
      │     ├── Here we try to write a PowerShell script that opens a connection on a port and then closes it.
      │     ├── We attempt to simulate the way attackers might try to keep in touch with target hosts periodically.
      │     └── Code: port_scheduler.ps1
      │
      ├── 6. Powershell Execution Policy
      │     ├── Rather than using PowerShell scripts to run commands present in an executable, we try to run a command directly using PowerShell commands themselves.
      │     ├── Sometimes, this requires changing the Execution Policy in our PowerShell, which is "Restricted" by default.
      │     └── Code: power.exe
      │
      └── 7. Advanced C2
            ├── The server (attacker) connects with the victim client. Due to a scheduler injected into the victim, the victim keeps executing the command sent by the attacker.
            ├── In our scenario, the attacker commands the victim to send the contents of a file to the attacker server. Any changes are also reflected because of the scheduler that keeps periodically sending the file's contents to the attacker.
            └── Code: server.exe on attacker host and client_scheduler.ps1 on victim host (Make sure to update the IP addresses in the client code to the attacker's IP. Ideally, for our code snippet, both the client and server should be on the same network to make it easier).
