$notepadProcess = Start-Process -FilePath notepad.exe -PassThru
$notepadPid = $notepadProcess.Id
# $message = "Hello, this is Phaneesh, your admin for the day!"

while ($true) {
    # Check if the notepad process is still running
    $process = Get-Process -Id $notepadPid -ErrorAction SilentlyContinue
    if ($process -eq $null) {
        # Notepad process is no longer running, open a new notepad and send the same message
        $notepadProcess = Start-Process -FilePath notepad.exe -PassThru
        $notepadPid = $notepadProcess.Id
        Start-Sleep -Milliseconds 500  # Wait for the new notepad window to open
        [System.Windows.Forms.SendKeys]::SendWait("Hello, this is Phaneesh, your admin for the day!")
    }

    # Sleep for a short duration to avoid high CPU usage
    Start-Sleep -Milliseconds 100
}

